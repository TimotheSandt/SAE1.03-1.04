{% extends "layout.html" %}

{% block title %}
État des Vélos
{% endblock %}

{% block body %}
<section>
    <h1>État des Vélos</h1>

    <form action="/velo/etat/" method="POST">
        <label for="selection_velo">Sélectionnez un vélo :</label>
        <select id="selection_velo" name="selection_velo" required>
            <option value="" disabled selected hidden>-- Sélectionnez un vélo --</option>
            {% for velo in selection_velos %}
                <option value="{{ velo.code_velo }}">{{ velo.libelle_velo }}</option>
            {% endfor %}
        </select>
        <button type="submit">Afficher l'état</button>
    </form>

    {% if velo %}
    <h2>Informations sur le Vélo</h2>
    <p><strong>Libellé :</strong> {{ velo.libelle_velo }}</p>
    <p><strong>Catégorie :</strong> {{ velo.categorie }}</p>
    <p><strong>État :</strong> {{ velo.etat }}</p>

    {% if stats %}
    <h2>Statistiques Générales</h2>
    <p><strong>Nombre de Locations :</strong> {{ stats.nb_locations }}</p>
    <p><strong>Durée Totale :</strong> {{ stats.duree_totale }} jours</p>
    <p><strong>Montant Total :</strong> {{ stats.montant_total }} €</p>
    {% endif %}

    <h2>Historique des Locations</h2>
    {% if locations %}
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Prix (€)</th>
                <th>Date Début</th>
                <th>Date Fin</th>
                <th>Locataire</th>
                <th>Bailleur</th>
            </tr>
        </thead>
        <tbody>
            {% for location in locations %}
            <tr>
                <td>{{ location.id }}</td>
                <td>{{ location.prix }}</td>
                <td>{{ location.date_debut }}</td>
                <td>{{ location.date_fin }}</td>
                <td>{{ location.locataire }}</td>
                <td>{{ location.bailleur }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>Aucune location enregistrée pour ce vélo.</p>
    {% endif %}
    {% endif %}
</section>
{% endblock %}
